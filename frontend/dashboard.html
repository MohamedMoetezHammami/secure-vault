<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#050507">
    <meta name="description" content="Secure Vault Dashboard - Manage your passwords securely">
    <title>Dashboard - Secure Vault</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- Preload fonts for better performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <button id="mobileMenuToggle" class="mobile-menu-toggle" aria-label="Toggle menu">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </button>
            <div class="nav-brand">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="nav-logo-icon">
                    <path d="M12 2L4 5V11.09C4 16.14 7.41 20.85 12 22C16.59 20.85 20 16.14 20 11.09V5L12 2Z"
                          fill="url(#navShieldGradient)" stroke="url(#navShieldStroke)" stroke-width="1"/>
                    <path d="M9 12L11 14L15 10" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <defs>
                        <linearGradient id="navShieldGradient" x1="4" y1="2" x2="20" y2="22" gradientUnits="userSpaceOnUse">
                            <stop offset="0%" stop-color="#6366f1"/>
                            <stop offset="50%" stop-color="#8b5cf6"/>
                            <stop offset="100%" stop-color="#d946ef"/>
                        </linearGradient>
                        <linearGradient id="navShieldStroke" x1="4" y1="2" x2="20" y2="22" gradientUnits="userSpaceOnUse">
                            <stop offset="0%" stop-color="#818cf8"/>
                            <stop offset="100%" stop-color="#e879f9"/>
                        </linearGradient>
                    </defs>
                </svg>
                <h2>Secure Vault</h2>
            </div>
            <div class="nav-actions">
                <button id="themeToggle" class="btn-icon" title="Toggle Theme">üåì</button>
                <div class="user-menu">
                    <button id="userMenuBtn" class="btn-icon">üë§</button>
                    <div id="userMenuDropdown" class="dropdown-menu">
                        <div class="user-info">
                            <strong id="userDisplayName"></strong>
                            <small id="userEmail"></small>
                        </div>
                        <hr>
                        <a href="#" id="settingsLink">‚öôÔ∏è Settings</a>
                        <a href="#" id="exportLink">üì• Export Data</a>
                        <a href="#" id="importLink">üì§ Import Data</a>
                        <hr>
                        <a href="#" id="logoutLink">üö™ Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <div id="mobileMenuOverlay" class="mobile-menu-overlay"></div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-section">
                <button class="btn btn-primary btn-block" id="addPasswordBtn">
                    ‚ûï Add Password
                </button>
            </div>
            <div class="sidebar-section">
                <h3>Categories</h3>
                <ul class="category-list" id="categoryList">
                    <li class="active" data-category="all">All Passwords</li>
                </ul>
            </div>
            <div class="sidebar-section">
                <h3>Tools</h3>
                <ul class="tool-list">
                    <li><a href="#" id="passwordGeneratorLink">üîë Password Generator</a></li>
                    <li><a href="#" id="securityCheckLink">üîí Security Check</a></li>
                    <li><a href="#" id="sharedPasswordsLink">üë• Shared Passwords</a></li>
                </ul>
            </div>
        </aside>

        <!-- Dashboard Content -->
        <div class="dashboard-content">
            <!-- Search and Filter Bar -->
            <div class="search-bar">
                <input type="text" id="searchInput" placeholder="Search passwords...">
                <select id="sortSelect">
                    <option value="newest">Newest First</option>
                    <option value="oldest">Oldest First</option>
                    <option value="az">A-Z</option>
                    <option value="za">Z-A</option>
                </select>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="totalPasswords">0</h3>
                    <p>Total Passwords</p>
                </div>
                <div class="stat-card">
                    <h3 id="weakPasswords">0</h3>
                    <p>Weak Passwords</p>
                </div>
                <div class="stat-card">
                    <h3 id="reusedPasswords">0</h3>
                    <p>Reused Passwords</p>
                </div>
                <div class="stat-card">
                    <h3 id="securityScore">-</h3>
                    <p>Security Score</p>
                </div>
            </div>

            <!-- Passwords List -->
            <div class="passwords-list" id="passwordsList">
                <div class="empty-state">
                    <p>No passwords saved yet. Click "Add Password" to get started!</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Bottom Navigation (Mobile) -->
    <nav class="bottom-nav">
        <a href="#" class="bottom-nav-item active" id="bottomNavHome" data-section="home">
            <span class="icon">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
            </span>
            <span>Home</span>
        </a>
        <a href="#" class="bottom-nav-item" id="bottomNavAdd" data-section="add">
            <span class="icon">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="16"></line>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                </svg>
            </span>
            <span>Add</span>
        </a>
        <a href="#" class="bottom-nav-item" id="bottomNavGenerator" data-section="generator">
            <span class="icon">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                </svg>
            </span>
            <span>Generate</span>
        </a>
        <a href="#" class="bottom-nav-item" id="bottomNavSecurity" data-section="security">
            <span class="icon">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                </svg>
            </span>
            <span>Security</span>
        </a>
        <a href="#" class="bottom-nav-item" id="bottomNavMenu" data-section="menu">
            <span class="icon">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="1"></circle>
                    <circle cx="12" cy="5" r="1"></circle>
                    <circle cx="12" cy="19" r="1"></circle>
                </svg>
            </span>
            <span>More</span>
        </a>
    </nav>

    <!-- Add/Edit Password Modal -->
    <div id="passwordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Add Password</h2>
                <button class="modal-close" id="closeModal">&times;</button>
            </div>
            <form id="passwordForm">
                <input type="hidden" id="passwordId">
                <div class="form-group">
                    <label for="website">Website/Service *</label>
                    <input type="text" id="website" required>
                </div>
                <div class="form-group">
                    <label for="username">Username/Email *</label>
                    <input type="text" id="username" required>
                </div>
                <div class="form-group">
                    <label for="password">Password *</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="password" required>
                        <button type="button" class="toggle-password" data-target="password">üëÅÔ∏è</button>
                        <button type="button" class="btn-icon" id="generatePasswordBtn" title="Generate Password">üé≤</button>
                    </div>
                    <div class="password-strength" id="passwordStrength"></div>
                </div>
                <div class="form-group">
                    <label for="category">Category</label>
                    <select id="category">
                        <option value="Uncategorized">Uncategorized</option>
                        <option value="Social Media">Social Media</option>
                        <option value="Email">Email</option>
                        <option value="Banking">Banking</option>
                        <option value="Shopping">Shopping</option>
                        <option value="Work">Work</option>
                        <option value="Personal">Personal</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="notes">Notes</label>
                    <textarea id="notes" rows="3"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Password</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Password Generator Modal -->
    <div id="generatorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Password Generator</h2>
                <button class="modal-close" id="closeGeneratorModal">&times;</button>
            </div>
            <div class="generator-content">
                <div class="generator-display">
                    <input type="text" id="generatedPassword" readonly>
                    <button class="btn btn-primary" id="copyGeneratedBtn">Copy</button>
                </div>
                <div class="generator-options">
                    <div class="form-group">
                        <label for="passwordLength">
                            Length: <span id="lengthValue">16</span>
                        </label>
                        <input type="range" id="passwordLength" min="8" max="64" value="16">
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="includeUppercase" checked>
                            Uppercase (A-Z)
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="includeLowercase" checked>
                            Lowercase (a-z)
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="includeNumbers" checked>
                            Numbers (0-9)
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="includeSymbols" checked>
                            Symbols (!@#$%^&*)
                        </label>
                    </div>
                    <button class="btn btn-primary btn-block" id="generateBtn">Generate Password</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Security Check Modal -->
    <div id="securityCheckModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2>üîí Security Check</h2>
                <button class="modal-close" id="closeSecurityCheckModal">&times;</button>
            </div>
            <div class="security-check-content">
                <div class="security-summary" id="securitySummary">
                    <p>Analyzing your passwords...</p>
                </div>
                <div class="security-details" id="securityDetails">
                    <div class="security-item" id="weakPasswordsSection" style="display: none;">
                        <h3>‚ö†Ô∏è Weak Passwords</h3>
                        <ul id="weakPasswordsList"></ul>
                    </div>
                    <div class="security-item" id="reusedPasswordsSection" style="display: none;">
                        <h3>üîÑ Reused Passwords</h3>
                        <ul id="reusedPasswordsList"></ul>
                    </div>
                    <div class="security-item" id="breachedPasswordsSection" style="display: none;">
                        <h3>üö® Breached Passwords</h3>
                        <ul id="breachedPasswordsList"></ul>
                    </div>
                </div>
                <div class="form-actions">
                    <button class="btn btn-primary" id="runSecurityCheckBtn">Run Security Check</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Shared Passwords Modal -->
    <div id="sharedPasswordsModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>üë• Shared Passwords</h2>
                <button class="modal-close" id="closeSharedPasswordsModal">&times;</button>
            </div>
            <div class="shared-passwords-content">
                <div class="shared-passwords-list" id="sharedPasswordsList">
                    <p>Loading shared passwords...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>‚öôÔ∏è Settings</h2>
                <button class="modal-close" id="closeSettingsModal">&times;</button>
            </div>
            <div class="settings-content">
                <form id="settingsForm">
                    <div class="form-group">
                        <label for="themeSetting">Theme</label>
                        <select id="themeSetting">
                            <option value="light">Light</option>
                            <option value="dark">Dark</option>
                            <option value="auto">Auto (System)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="autoLogoutSetting">
                            Auto-logout after inactivity (minutes)
                        </label>
                        <input type="number" id="autoLogoutSetting" min="5" max="120" value="30">
                        <small>Automatically log out after this many minutes of inactivity</small>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="rememberMasterPassword">
                            Remember master password (not recommended)
                        </label>
                        <small>If enabled, your master password will be remembered in this browser</small>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="showPasswordStrength">
                            Show password strength indicator
                        </label>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" id="cancelSettingsBtn">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Settings</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Export Data Modal -->
    <div id="exportModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>üì• Export Data</h2>
                <button class="modal-close" id="closeExportModal">&times;</button>
            </div>
            <div class="export-content">
                <p>Export all your passwords to a JSON file for backup.</p>
                <div class="form-group">
                    <label>
                        <input type="radio" name="exportFormat" value="encrypted" checked>
                        Export encrypted (recommended) - Can be imported back securely
                    </label>
                </div>
                <div class="form-group">
                    <label>
                        <input type="radio" name="exportFormat" value="decrypted">
                        Export decrypted (plaintext) - For migration to other password managers
                    </label>
                    <small class="warning">‚ö†Ô∏è Warning: Decrypted export contains plaintext passwords. Keep this file secure!</small>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelExportBtn">Cancel</button>
                    <button type="button" class="btn btn-primary" id="exportDataBtn">Export Data</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Import Data Modal -->
    <div id="importModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>üì§ Import Data</h2>
                <button class="modal-close" id="closeImportModal">&times;</button>
            </div>
            <div class="import-content">
                <p>Import passwords from a JSON backup file.</p>
                <div class="form-group">
                    <label for="importFile">Select JSON file</label>
                    <input type="file" id="importFile" accept=".json" required>
                    <small>Select the exported JSON file from this password manager</small>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="overwriteExisting">
                        Overwrite existing passwords with same website/username
                    </label>
                </div>
                <div id="importPreview" style="display: none; margin: 1rem 0; padding: 1rem; background: var(--bg-secondary); border-radius: var(--border-radius);">
                    <strong>Preview:</strong>
                    <p id="importPreviewText"></p>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelImportBtn">Cancel</button>
                    <button type="button" class="btn btn-primary" id="importDataBtn" disabled>Import Data</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
    </div>

    <!-- Floating Action Button (Mobile) -->
    <button class="fab" id="fabAddPassword" aria-label="Add password">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
    </button>

    <!-- Scripts -->
    <!-- Mobile initialization (load first, but will only work in Capacitor) -->
    <script src="js/mobile-init.js"></script>
    <!-- Load CryptoJS first -->
    <script src="js/crypto-js.min.js"></script>
    <!-- Load utility scripts (must be before dashboard.js) -->
    <script src="js/encryption.js"></script>
    <script src="js/password-generator.js"></script>
    <script src="js/ui.js"></script>
    <!-- Dashboard module (loads last) -->
    <script type="module" src="js/dashboard.js"></script>
</body>
</html>

